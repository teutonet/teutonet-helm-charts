{{- if .Values.weaveworks.enabled }}
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  annotations:
    metadata.weave.works/description: This is the Weave GitOps Dashboard.  It provides
      a simple way to get insights into your GitOps workloads.
  name: weave-dashboard
  namespace: weave
spec:
  chart:
    spec:
      chart: weave-gitops
      sourceRef:
        kind: HelmRepository
        name: weaveworks
  interval: 5m
  values:
    replicaCount: 1
    {{- if .Values.weaveworks.adminUser.create }}
    adminUser:
      create: true
      username: {{ .Values.weaveworks.adminUser.username }}
      createSecret: true
    {{- end }}
    {{- if .Values.weaveworks.ingress.enabled }}
    ingress:
      enabled: true
      host: {{ .Values.weaveworks.ingress.host }}
    {{- end }}
    metrics:
      enabled: {{ .Values.monitoring.prometheus.enabled }}
{{- end }}