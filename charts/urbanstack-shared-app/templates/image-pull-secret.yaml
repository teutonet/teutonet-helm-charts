{{- if and .Values.registryAuth.username .Values.registryAuth.password -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ printf "pullsecret-%s" .Release.Name | quote }}
  labels: {{- include "urbanstack-shared-app.labels" . | nindent 4 }}
type: kubernetes.io/dockerconfigjson
stringData:
  .dockerconfigjson: {{ dict "auths" (dict .Values.image.registry (dict "auth" (printf "%s:%s" .Values.registryAuth.username .Values.registryAuth.password | b64enc))) | toJson | quote }}
{{- end -}}
