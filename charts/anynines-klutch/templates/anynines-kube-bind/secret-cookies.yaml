{{- $secretName := printf "%s-kube-bind-cookies" (include "common.names.fullname" .) -}}
{{- $secret := lookup "v1" "Secret" .Release.Namespace $secretName -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ $secretName }}
  namespace: {{ .Release.Namespace }}
  labels: {{- include "common.labels.standard" . | nindent 4 }}
type: Opaque
{{- if $secret }}
data:
{{- else }}
stringData:
{{- end }}
  # This might change on every `template` call, this can be ignored
  signing-key: {{ include "common.secrets.passwords.manage" (dict "secret" $secretName "length" 32 "strong" false "key" "signing-key" "failOnNew" false "context" $ "providedValues" (list)) }}
  encryption-key: {{ include "common.secrets.passwords.manage" (dict "secret" $secretName "length" 32 "strong" false "key" "encryption-key" "failOnNew" false "context" $ "providedValues" (list)) }}
