{{- $name := "ckan" -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ printf "%s-%s-config" (include "common.names.fullname" $) $name | quote }}
  labels: {{- include "common.labels.standard" . | nindent 4 }}
    app.kubernetes.io/component: {{ $name }}
stringData:
  sysAdminUsername: {{ .Values.ckan.sysadmin.name | quote }}
  sysAdminPassword: {{ .Values.ckan.sysadmin.password | quote }}
  sysAdminEmail: {{ .Values.ckan.sysadmin.email | quote }}
  {{- if .Values.ckan.smtp }}
  smtpPassword: {{ .Values.ckan.smtp.password | quote }}
  {{- end }}
  postgresUsername: {{ .Values.postgresql.auth.postgresPassword | quote}}
  ckanDatabaseUsername: {{ .Values.postgresql.auth.username | quote }}
  ckanDatabasePassword: {{ .Values.postgresql.auth.password | quote }}
  ckanSqlAlchemyUrl: "postgresql://{{ .Values.postgresql.auth.username }}:{{ .Values.postgresql.auth.password }}@{{ printf "%s-%s" (include "common.names.fullname" $) "postgresql" }}/{{ .Values.postgresql.auth.database}}"
  datastoreUsername: {{ .Values.postgresql.ckanDbs.datastoreUsername | quote}}
  datastorePassword: {{ .Values.postgresql.ckanDbs.datastorePassword | quote}}
  datastoreWriteUrl: "postgresql://{{ .Values.postgresql.auth.username }}:{{ .Values.postgresql.auth.password }}@{{ printf "%s-%s" (include "common.names.fullname" $) "postgresql" }}/{{ .Values.postgresql.ckanDbs.datastoreDb}}"
  datastoreReadUrl: "postgresql://{{ .Values.postgresql.ckanDbs.datastoreUsername }}:{{ .Values.postgresql.ckanDbs.datastorePassword }}@{{ printf "%s-%s" (include "common.names.fullname" $) "postgresql" }}/{{ .Values.postgresql.ckanDbs.datastoreDb}}"
  datapusherUsername: {{ .Values.postgresql.ckanDbs.datapusherUsername | quote}}
  datapusherPassword: {{ .Values.postgresql.ckanDbs.datapusherPassword | quote}}
  {{- if .Values.solr.auth.enabled }}
  solrUsername: {{ .Values.solr.auth.adminUsername }}
  solrPassword: {{ .Values.solr.auth.adminPassword }}
  {{- end }}